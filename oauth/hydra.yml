version: v1.11.8

dsn: postgres://hydra:secret@mealie-oauth-db:5432/hydra?sslmode=disable

webfinger:
  jwks:
    broadcast_keys:
      - hydra.openid.id-token
  oidc_discovery:
    supported_claims:
      - sub
      - name
      - email
    supported_scope:
      - offline
      - openid

urls:
  self:
    issuer: https://rainworth-server.tailbf31d9.ts.net/oauth
  consent: https://rainworth-server.tailbf31d9.ts.net/consent
  login: https://rainworth-server.tailbf31d9.ts.net/login
  error: https://rainworth-server.tailbf31d9.ts.net/error
  post_logout_redirect: https://rainworth-server.tailbf31d9.ts.net/logout

strategies:
  access_token: jwt
  scope: exact

ttl:
  access_token: 1h
  refresh_token: 720h  # 30 days
  id_token: 1h
  auth_code: 10m
  login_consent_request: 30m

oauth2:
  expose_internal_errors: true
  pkce:
    enforced: true
    enforced_for_public_clients: true
  grant:
    jwt:
      max_ttl: 1h
  session:
    encrypt_at_rest: true

secrets:
  system:
    - this-is-the-primary-secret-replace-it-with-a-real-secret

serve:
  cookies:
    same_site_mode: None
    same_site_legacy_workaround: true
    domain: rainworth-server.tailbf31d9.ts.net
    path: /
  public:
    request_log:
      disable_for_health: true
    override_trust_forwarded_headers: true
    override_return_to_urls_allowed: true
    cors:
      enabled: true
      allowed_origins:
        - "*"
      allowed_methods:
        - POST
        - GET
        - PUT
        - PATCH
        - DELETE
      allowed_headers:
        - Authorization
        - Content-Type
        - Accept
      exposed_headers:
        - Content-Type
        - Mcp-Session-Id
      allow_credentials: true
